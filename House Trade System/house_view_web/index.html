<!DOCTYPE html>

<html lang="en" xmlns:v-on="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>二手房交易平台</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <script src="vue.js" charset="utf-8"></script>
    <!-- <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css"> -->
    <!-- <script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script> -->
    <!-- <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script> -->
    <script src="node_modules/jquery/dist/jquery.js" charset="utf-8"></script>
    <link rel="stylesheet" href="node_modules/bootstrap/dist/css/bootstrap.css">
    <link rel="stylesheet" href="node_modules/font-awesome/css/font-awesome.css">
    <script src="node_modules/bootstrap/dist/js/bootstrap.js"></script>

</head>
<style>
    /* Make the image fully responsive */
    .carousel-inner img {
        width: 100%;
        height: 100%;
    }
</style>



<body>
<div id="app">
    <nav class="navbar navbar-expand-md bg-dark navbar-dark">
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
            <span class="navbar-toggler-icon"></span>
        </button>
        <a class="navbar-brand" href="index.html">二手房交易平台</a>
        <div class="collapse navbar-collapse" id="collapsibleNavbar">
            <ul class="navbar-nav">
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="BuyDisk.html" id="navbarDropdown" role="button"
                       data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <span class="fa fa-search"></span>
                        我要买房!
                    </a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                        <a class="dropdown-item" href="BuyDisk.html">
                            <span class="fa fa-search-plus"></span>
                            直接搜小区
                        </a>
                        <a class="dropdown-item" href="BuyArea.html">
                            <span class="fa fa-search-minus"></span>
                            按区域找房
                        </a>
                    </div>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="Sale.html">
                        <i class="fa fa-gavel"></i>我要卖房!
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">
                        <i class="fa fa-info"></i>
                        帮助
                    </a>
                </li>
                <li class="nav-item">
                    <a id="userLabel" class="nav-link" data-toggle="modal" data-target="#loginModal">
                        <i class="fa fa-user-circle"></i>
                        登录
                    </a>
                </li>

                <!--<li v-if="auth" class="nav-item">-->
                    <!--<a class="nav-link" onclick="alert('欢迎使用！');">-->
                        <!--<i class="fa fa-user-circle"></i>-->
                        <!--{{ userName }}-->
                    <!--</a>-->
                <!--<li v-else class="nav-item">-->
                    <!--<a class="nav-link" data-toggle="modal" data-target="#loginModal">-->
                        <!--<i class="fa fa-user-circle"></i>-->
                        <!--登录-->
                    <!--</a>-->
                <!--</li>-->
            </ul>
        </div>
    </nav>
    <br>
    <div >
        <!-- 模态框（Modal） -->
        <!-- 注册窗口 -->
        <div id="signupModal" class="modal fade" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-body">
                        <button class="close" data-dismiss="modal">
                            <span>&times;</span>
                        </button>
                    </div>
                    <div class="modal-title">
                        <h1 class="text-center">注册</h1>
                    </div>
                    <div class="modal-body">
                        <form class="form-group" onsubmit="return false;">
                            <div class="form-group">
                                <label>账号</label>
                                <input v-model="userID" class="form-control" type="text" placeholder="">
                            </div>
                            <div class="form-group">
                                <label>密码(6位数字)</label>
                                <input v-model="password" class="form-control" type="password" placeholder="">
                            </div>
                            <div class="form-group">
                                <label>手机</label>
                                <input v-model="phoneNumber" class="form-control" type="text" placeholder="">
                            </div>
                            <div class="text-right">
                                <button class="btn btn-primary" type="submit">提交</button>
                                <button class="btn btn-danger" data-dismiss="modal">取消</button>
                            </div>
                            <a href="" data-toggle="modal" data-dismiss="modal" data-target="#loginModal">已有账号？点我登录</a>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <!-- 登录窗口 -->
        <div id="loginModal" class="modal fade">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-body">
                        <button class="close" data-dismiss="modal">
                            <span>&times;</span>
                        </button>
                    </div>
                    <div class="modal-title">
                        <h1 class="text-center">登录</h1>
                    </div>
                    <div class="modal-body">
                        <form class="form-group" onsubmit="return false;">
                            <div class="form-group">
                                <label>账号</label>
                                <input id="userID" v-model="userID" class="form-control" type="text" placeholder="">
                            </div>
                            <div class="form-group">
                                <label>密码</label>
                                <input id="password" v-model="password" class="form-control" type="password" placeholder="">
                            </div>
                            <div class="text-right">
                                <button class="btn btn-primary" type="submit" v-on:click="login">登录</button>
                                <button class="btn btn-danger" data-dismiss="modal">取消</button>
                            </div>
                            <a href="" data-toggle="modal" data-dismiss="modal" data-target="#signupModal">还没有账号？点我注册</a>
                            <a id="showResult" data-toggle="modal" data-dismiss="modal" data-target="#resultModal"></a>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div id="resultModal" class="modal fade">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-body">
                        <button class="close" data-dismiss="modal">
                            <span>&times;</span>
                        </button>
                    </div>
                    <div class="modal-title">
                        <h1 class="text-center">你好！</h1>
                    </div>
                    <div class="modal-body justify-text-center">
                        <div>{{ returnMessage }}</div>
                       
                        <div class="row col-12 justify-content-center">
                            <button class="btn btn-info col-4 " onclick="sessionStorage.clear(); userControl(); location.reload(true);  ">注销</button>
                            <div class="col-4"></div>
                            <button class="btn btn-primary col-4" v-on:click="MyOnsale">我的挂牌房源...</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div class="container">
        <blockquote>
            <h5>
                The house of every one is to him as his castle and fortress.
            </h5>
            <small>——<cite>D.Herbert Lawrence</cite></small>
        </blockquote>

        <div id="demo" class="carousel slide mb-2" data-ride="carousel">

            <!-- 指示符 -->
            <ul class="carousel-indicators">
                <li data-target="#demo" data-slide-to="0" class="active"></li>
                <li data-target="#demo" data-slide-to="1"></li>
            </ul>


            <!-- 轮播图片 -->
            <div class="carousel-inner">
                <div class="carousel-item active">
                    <img src="images/banner.jpg">
                </div>
                <div class="carousel-item">
                    <img src="images/bannerV2.jpg">
                </div>
            </div>

            <!-- 左右切换按钮 -->
            <a class="carousel-control-prev" href="#demo" data-slide="prev">
                <span class="carousel-control-prev-icon"></span>
            </a>
            <a class="carousel-control-next" href="#demo" data-slide="next">
                <span class="carousel-control-next-icon"></span>
            </a>
        </div>
    </div>
    <br>

    <div class="container">
        <div class="row clearfix">
            <div class="col-md-12 column">

                <div class="jumbotron">
                    <h1>
                        连接每一个家的故事
                    </h1>
                    <p>
                        <small>在这里，你可以挂牌、找房、买房、卖房！</small>
                    </p>
                    <div class="form-group">
                        <a class="btn btn-primary btn-large" href="BuyDisk.html">
                            <span class="fa fa-search"></span>
                            查找心仪的房源</a>
                    </div>
                </div>
                <!--<div class="col-6">-->
                    <!--<img src="images/header.gif" style="">-->
                <!--</div>-->
            </div>
        </div>
    </div>

    <div class="container">
        <div class="col-md-12 column">
            <div class="row">
                <div class="col-md-4">
                    <div class="thumbnail">
                        <img src="images/bieshu.jpg" class="img-rounded" width="304" height="236"/>
                        <div class="caption">
                            <br>
                            <h3>
                                办公型
                            </h3>
                            <br>
                            <p>
                                <small>
                                    办公型多为写字楼和办公室。上海办公型丰富,
                                    继续以<br>评估您想查询的别墅价格。
                                </small>
                            </p>
                            <p>
                                <a class="btn btn-primary" href="BuyDisk.html">查找房子</a>
                            </p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="thumbnail">
                        <img src="images/gongyu.png" class="img-rounded" width="304" height="236"/>
                        <div class="caption">
                            <br>
                            <h3>
                                公寓型
                            </h3>
                            <br>
                            <p>
                                <small>
                                    一间公寓是一个人的起点。上海公寓类型多样,继续以<br>评估您想查询的公寓价格。
                                </small>
                            </p>

                            <p>
                                <a class="btn btn-primary" href="BuyDisk.html">查找房子</a>
                            </p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="thumbnail">
                        <img src="images/minsu.jpg" class="img-rounded" width="304" height="236"/>
                        <div class="caption">
                            <br>
                            <h3>
                                民宿型
                            </h3>
                            <br>
                            <p>
                                <small>
                                    上海市民待人热情,民宿样式各种各样。继续以评估您想<br>查询的民宿价格。
                                </small>
                            </p>
                            <p>
                                <a class="btn btn-primary" href="BuyDisk.html">查找房子</a>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


</div>
</body>


<script type="text/javascript">
    new Vue({
        el: '#app',
        data: {
            userID: "",
            password: "",
            phoneNumber: "",
            returnMessage: "",
            auth: false,
            userName: ""
        },
        methods: {
            signup: function (event) {
                let json = {
                    userID: this.userID,
                    password: this.password,
                    phoneNumber: this.phoneNumber
                };
            },

            login: function (event) {
                let json = {
                    userID: this.userID,
                    password: this.password
                };
                let vm = this;

                $.ajax({
                    url: "http://localhost:8090/user/login",
                    dataType: "json",
                    type: "post",
                    data: JSON.stringify(json),
                    contentType: "application/json",
                    xhrFields: {
                      withCredentials: true     // 跨域请求服务器，必须设置为true才可以设置cookie。在服务器端必须同时设置。
                    },
                    success: function (response) {
                        if (response['status'] === 'ok') {
                            vm.returnMessage = "欢迎你，\n" + response['data'];
                            $("#showResult").click();
                            vm.userName = response['userName'];
                            vm.auth = true;
                            sessionStorage.setItem("userName", vm.userName);
                            userControl();
                        }
                        if (response['status'] === 'wrong') {
                            vm.returnMessage = "错误，\n" + response['data'];
                            $("#showResult").click();
                        }

                    },
                    error: function (response) {
                        vm.returnMessage = "登录失败! 网络问题！"
                        $("#showResult").click();
                    },

                });
            },

            MyOnsale: function(event){
                window.location = "MyHouses.html";
            }
        }
    });


    function userControl() {
        let userName = sessionStorage.getItem('userName');
        if(userName == null){
            console.log("login first");
        }
        else{
            // alert(userName);
            var label = $("#userLabel");
            label.html("<i class=\"fa fa-user\"></i>" + userName);
            label[0].setAttribute("data-toggle", "modal");
            label[0].setAttribute("data-target", "#resultModal");
        }
    }

    userControl();

</script>

</html>